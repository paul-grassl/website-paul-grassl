---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { SITE } from "@/config";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

const title = "Exhibitions";
const description = "Exhibitions by Paul Graßl";
const exhibitions = (await getCollection("exhibitions"))
  .sort((a, b) => {
    // Parse the start date from the period field (format like "March 7 – March 13, 2025")
    const getStartDate = (period: string) => {
      const [startPart] = period.split("–").map(p => p.trim());
      const year = period.split(", ")[1];
      // Convert month name and day to a consistent date format
      const date = new Date(`${startPart}, ${year}`);
      return date;
    };
    
    const dateA = getStartDate(a.data.period);
    const dateB = getStartDate(b.data.period);
    // Sort in descending order (newest first)
    return dateB.getTime() - dateA.getTime();
  });
---

<Layout title={title} description={description}>
	<Header />
	<main id="main-content">
		<section class="mx-auto w-full max-w-6xl px-2 py-8 flex flex-col items-center">
			{exhibitions.map(exhibition => (
				        <div class="flex flex-col w-full max-w-5xl mb-16">
          <div class="w-full aspect-[3/2] bg-muted overflow-hidden">
            <Image 
              src={exhibition.data.image} 
              alt={exhibition.data.title} 
              class="object-cover w-full h-full"
              width={1920}
              height={1280}
              quality={80}
              format="webp"
              densities={[1, 2]}
              loading="lazy"
              fit="cover"
            />
          </div>
          <div class="mt-4 w-full">
            <h3 class="text-lg italic text-foreground font-normal leading-tight">{exhibition.data.title}</h3>
            <div class="mt-0.5 flex flex-col gap-y-0.5 text-lg text-muted-foreground">
              <span>{exhibition.data.location}</span>
              <span>{exhibition.data.period}</span>
            </div>
          </div>
				</div>
			))}
		</section>
	</main>
	<Footer />
</Layout> 