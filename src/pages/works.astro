---
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { SITE } from "@/config";
import { getCollection } from "astro:content";

const title = "Works";
const description = "Artwork by Paul GraÃŸl";

// Get all works and organize by year
const allWorks = await getCollection("works");
const worksByYear = allWorks.reduce((acc, work) => {
  const year = work.data.year;
  if (!acc[year]) {
    acc[year] = [];
  }
  acc[year].push(work);
  return acc;
}, {} as Record<number, typeof allWorks>);

// Sort years in descending order
const sortedYears = Object.keys(worksByYear)
  .map(year => parseInt(year))
  .sort((a, b) => b - a);
---

<Layout title={title} description={description}>
	<Header />
	<main id="main-content">
		<section class="mx-auto w-full max-w-5xl px-6 py-8 flex flex-col">
			<h1 class="text-2xl font-normal leading-tight mb-12 text-foreground">Works</h1>
			<div class="flex flex-col gap-8">
				{sortedYears.map(year => (
					<div class="w-full">
						<a href={`/works/${year}`} class="group flex flex-col cursor-pointer">
							<h2 class="text-xl font-normal leading-tight transition-colors group-hover:text-accent mb-4">
								Works {year}
							</h2>
							<div class="text-lg text-muted-foreground transition-colors group-hover:text-accent">
								{worksByYear[year].length} {worksByYear[year].length === 1 ? 'work' : 'works'}
							</div>
						</a>
					</div>
				))}
			</div>
		</section>
	</main>
	<Footer />
</Layout> 